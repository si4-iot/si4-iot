{"ast":null,"code":"var _jsxFileName = \"/home/nat/Documentos/IC-TCC/Projeto/catalogo-app/src/components/read.component.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Wot from '@node-wot/core';\n\nconst Description = props => React.createElement(\"tr\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 6\n  },\n  __self: this\n}, React.createElement(\"td\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 7\n  },\n  __self: this\n}, props.description.id), React.createElement(\"td\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 8\n  },\n  __self: this\n}, props.description.title));\n\nexport default class ReadDesc extends Component {\n  constructor(props) {\n    var servient;\n    super(props);\n    this.state = {\n      description: [],\n      counterProperties: []\n    };\n    this._isMounted = false;\n    servient = new Wot.Core.Servient();\n    servient.addClientFactory(new Wot.Http.HttpClientFactory());\n\n    window.onload = () => {\n      this.get_td(document.getElementById(\"td_addr\").value);\n    };\n  }\n\n  updateProperties() {\n    this.counterProperties.forEach(function (prop) {\n      prop.click();\n    });\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    axios.get('http://localhost:4000/td/' + this.props.match.params.id).then(response => {\n      this.setState({\n        description: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentDidUpdate() {\n    axios.get('http://localhost:4000/td/').then(response => {\n      this.setState({\n        description: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  descriptionList() {\n    axios.get('http://localhost:4000/td/' + this.props.match.params.id).then(response => {\n      this.state.description.push({\n        id: response.data.id,\n        title: response.data.title\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    return React.createElement(Description, {\n      description: this.state.description,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        marginTop: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"Cat\\xE1logo\"), React.createElement(\"table\", {\n      className: \"table table-striped\",\n      style: {\n        marginTop: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, \"ID\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, \"Title\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, this.descriptionList())), React.createElement(\"div\", {\n      id: \"topbar\",\n      class: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"medium-12 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Counter Client Example in the Browser\"), React.createElement(\"input\", {\n      type: \"hidden\",\n      id: \"td_addr\",\n      type: \"url\",\n      value: \"http://plugfest.thingweb.io:8083/counter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      id: \"interactions\",\n      class: \"row\",\n      style: \"display: none;\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, \"Properties\")), React.createElement(\"dl\", {\n      id: \"properties\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"Actions\")), React.createElement(\"ul\", {\n      id: \"actions\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"Events\")), React.createElement(\"ul\", {\n      id: \"events\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    })))));\n  }\n\n  get_td(addr) {\n    servient.start().then(thingFactory => {\n      thingFactory.fetch(addr).then(td => {\n        var thing = thingFactory.consume(td);\n        showInteractions(thing);\n      }).catch(error => {\n        window.alert(\"Could not fetch TD.\\n\" + error);\n      });\n    });\n  }\n\n  showInteractions(thing) {\n    counterProperties = [];\n\n    for (let property in thing.properties) {\n      if (thing.properties.hasOwnProperty(property)) {\n        let dtItem = document.createElement(\"dt\");\n        counterProperties.push(dtItem);\n        let ddItem = document.createElement(\"dd\");\n        ddItem.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n        ddItem.appendChild(document.createTextNode(\"???\"));\n        dtItem.appendChild(link);\n        document.getElementById(\"properties\").appendChild(dtItem);\n        document.getElementById(\"properties\").appendChild(ddItem);\n\n        dtItem.onclick = click => {\n          thing.properties[property].read().then(res => {\n            ddItem.textContent = res;\n          } // res => window.alert(property + \": \" + res)\n          ).catch(err => window.alert(\"error: \" + err));\n        }; // update value right-away\n\n\n        dtItem.click();\n      }\n    }\n\n    ;\n\n    for (let action in thing.actions) {\n      if (thing.actions.hasOwnProperty(action)) {\n        let item = document.createElement(\"li\");\n        item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n        let button = document.createElement(\"button\");\n        button.appendChild(document.createTextNode(action));\n        button.className = \"button tiny secondary\";\n        item.appendChild(button);\n        document.getElementById(\"actions\").appendChild(item);\n\n        item.onclick = click => {\n          thing.actions[action].invoke().then(res => {\n            button.style.background = 'rgb(0,255,0,0.2)';\n            setTimeout(function () {\n              button.style.background = null;\n            }, 500);\n            updateProperties();\n          }).catch(err => {\n            button.style.background = 'rgb(255,0,0,0.2)';\n            setTimeout(function () {\n              button.style.background = null;\n            }, 500);\n          });\n        };\n      }\n    }\n\n    ;\n    let eventSubscriptions = {};\n\n    for (let evnt in thing.events) {\n      if (thing.events.hasOwnProperty(evnt)) {\n        let item = document.createElement(\"li\");\n        item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n        let link = document.createElement(\"a\");\n        link.appendChild(document.createTextNode(evnt));\n        let checkbox = document.createElement(\"div\");\n        checkbox.className = \"switch small\";\n        checkbox.innerHTML = '<input id=\"' + evnt + '\" type=\"checkbox\">\\n<label for=\"' + evnt + '\"></label>';\n        item.appendChild(link);\n        item.appendChild(checkbox);\n        document.getElementById(\"events\").appendChild(item);\n\n        checkbox.onclick = click => {\n          if (document.getElementById(evnt).checked && !eventSubscriptions[evnt]) {\n            eventSubscriptions[evnt] = thing.events[evnt].subscribe(response => {\n              // window.alert(\"Event \" + evnt + \" detected\\nMessage: \" + response);\n              updateProperties();\n            }, error => {\n              window.alert(\"Event \" + evnt + \" error\\nMessage: \" + error);\n            });\n          } else if (!document.getElementById(evnt).checked && eventSubscriptions[evnt]) {\n            eventSubscriptions[evnt].unsubscribe();\n          }\n        };\n      }\n    }\n\n    ; // Check if visible\n\n    let placeholder = document.getElementById(\"interactions\");\n\n    if (placeholder.style.display === \"none\") {\n      placeholder.style.display = \"block\";\n    }\n  }\n\n}","map":{"version":3,"sources":["/home/nat/Documentos/IC-TCC/Projeto/catalogo-app/src/components/read.component.js"],"names":["React","Component","axios","Wot","Description","props","description","id","title","ReadDesc","constructor","servient","state","counterProperties","_isMounted","Core","Servient","addClientFactory","Http","HttpClientFactory","window","onload","get_td","document","getElementById","value","updateProperties","forEach","prop","click","componentWillUnmount","componentDidMount","get","match","params","then","response","setState","data","catch","error","console","log","componentDidUpdate","descriptionList","push","render","marginTop","addr","start","thingFactory","fetch","td","thing","consume","showInteractions","alert","property","properties","hasOwnProperty","dtItem","createElement","ddItem","setAttribute","appendChild","createTextNode","link","onclick","read","res","textContent","err","action","actions","item","button","className","invoke","style","background","setTimeout","eventSubscriptions","evnt","events","checkbox","innerHTML","checked","subscribe","unsubscribe","placeholder","display"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axios from 'axios';\nimport Wot from '@node-wot/core';\n\nconst Description = props => (\n    <tr>\n        <td>{props.description.id}</td>\n        <td>{props.description.title}</td>\n    </tr>\n)\n\n\nexport default class ReadDesc extends Component {\n    \n    constructor(props) {\n        var servient;\n        super(props);\n        this.state = {\n            description: [], \n            counterProperties: []};\n        this._isMounted = false;\n        servient = new Wot.Core.Servient();\n        servient.addClientFactory(new Wot.Http.HttpClientFactory());\n        window.onload = () => {\n            this.get_td(document.getElementById(\"td_addr\").value);\n        }\n    }\n    \n    \n     \n    \n    updateProperties() {\n        this.counterProperties.forEach(function(prop) {\n          prop.click();\n        });\n    }\n    \n    componentWillUnmount() {\n        this._isMounted = false;\n        \n    }\n    \n    componentDidMount() {\n        this._isMounted = true;\n\n        axios.get('http://localhost:4000/td/'+this.props.match.params.id)\n            .then(response => {\n                this.setState({\n                    description: response.data\n                })\n            })\n            .catch(function(error) {\n                console.log(error)\n            })\n    }\n\n    componentDidUpdate() {\n        axios.get('http://localhost:4000/td/')\n        .then(response => {\n            this.setState({description: response.data});\n        })\n        .catch(function (error) {\n            console.log(error);\n        })   \n    }\n\n    descriptionList() {\n        axios.get('http://localhost:4000/td/'+this.props.match.params.id)\n        .then(response => {\n            this.state.description.push({\n                    id:response.data.id,\n                    title: response.data.title\n                });\n            })\n        .catch(function(error) {\n            console.log(error)\n        })\n        return <Description description={this.state.description} />;\n    }\n\n    render() {\n        return (\n            <div style={{ marginTop: 20 }}>\n                <h3>Catálogo</h3>\n                <table className=\"table table-striped\" style={{ marginTop: 20 }}>\n                    <thead>\n                        <tr>\n                            <th>ID</th>\n                            <th>Title</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        { this.descriptionList() }    \n                    </tbody>\n                </table>\n        <div id=\"topbar\" class=\"row\">\n            <div class=\"medium-12 columns\">\n              <h1>Counter Client Example in the Browser</h1>\n              <input type=\"hidden\" id=\"td_addr\" type=\"url\" value=\"http://plugfest.thingweb.io:8083/counter\"/>\n            </div>\n        </div>\n          <div id=\"interactions\" class=\"row\" style=\"display: none;\">\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Properties</h4></figcaption>\n                <dl id=\"properties\" class=\"side-nav\"></dl>\n              </figure>\n            </div>\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Actions</h4></figcaption>\n                <ul id=\"actions\" class=\"side-nav\"></ul>\n              </figure>\n            </div>\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Events</h4></figcaption>\n                <ul id=\"events\" class=\"side-nav\"></ul>\n              </figure>\n            </div>\n          </div>\n          </div>\n        )\n    }\n\n    get_td(addr) {\n        servient.start().then((thingFactory) => {\n            thingFactory.fetch(addr).then((td) => {\n                var thing = thingFactory.consume(td);\n                showInteractions(thing);\n            }).catch((error) => {\n                window.alert(\"Could not fetch TD.\\n\" + error)\n            })\n        })\n    }\n    \n    showInteractions(thing) {\n        counterProperties = [];\n        for ( let property in thing.properties ) {\n            if (thing.properties.hasOwnProperty(property)) {\n                let dtItem = document.createElement(\"dt\");\n                counterProperties.push(dtItem);\n                let ddItem = document.createElement(\"dd\");\n                ddItem.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n                ddItem.appendChild(document.createTextNode(\"???\"));   \n                dtItem.appendChild(link);\n                document.getElementById(\"properties\").appendChild(dtItem);\n                document.getElementById(\"properties\").appendChild(ddItem);\n    \n                dtItem.onclick = (click) => {\n                    thing.properties[property].read()\n                    .then(\n                        res => { ddItem.textContent = res; }\n                        // res => window.alert(property + \": \" + res)\n                    )\n                    .catch(err => window.alert(\"error: \" + err))\n                }\n                \n                // update value right-away\n                dtItem.click();\n            }\n        };\n        for ( let action in thing.actions ) {\n            if (thing.actions.hasOwnProperty(action)) {\n                let item = document.createElement(\"li\");\n                item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n                let button = document.createElement(\"button\");\n                button.appendChild(document.createTextNode(action));\n                button.className = \"button tiny secondary\"\n                item.appendChild(button)\n                document.getElementById(\"actions\").appendChild(item);\n    \n                item.onclick = (click) => { \n                    thing.actions[action].invoke()\n                        .then((res) => { \n                            button.style.background = 'rgb(0,255,0,0.2)';\n                            setTimeout(function () {\n                              button.style.background = null;\n                            }, 500);\n                            updateProperties();\n                        })\n                        .catch((err) => {\n                            button.style.background = 'rgb(255,0,0,0.2)';\n                            setTimeout(function () {\n                              button.style.background = null;\n                            }, 500);\n                        })\n                }\n            }\n        };\n        let eventSubscriptions = {}\n        for ( let evnt in thing.events ) {\n            if (thing.events.hasOwnProperty(evnt)) {\n                let item = document.createElement(\"li\");\n                item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n                let link = document.createElement(\"a\");\n                link.appendChild(document.createTextNode(evnt));\n    \n                let checkbox = document.createElement(\"div\");\n                checkbox.className = \"switch small\"\n                checkbox.innerHTML = '<input id=\"' + evnt + '\" type=\"checkbox\">\\n<label for=\"' + evnt + '\"></label>'\n                item.appendChild(link);\n                item.appendChild(checkbox)\n                document.getElementById(\"events\").appendChild(item);\n    \n                checkbox.onclick = (click) => {\n                    if (document.getElementById(evnt).checked && !eventSubscriptions[evnt]) {\n                        eventSubscriptions[evnt] = thing.events[evnt].subscribe(\n                            (response) => {\n                                // window.alert(\"Event \" + evnt + \" detected\\nMessage: \" + response);\n                                updateProperties();\n                            },\n                            (error) => { window.alert(\"Event \" + evnt + \" error\\nMessage: \" + error); }\n                        )\n                    } else if (!document.getElementById(evnt).checked && eventSubscriptions[evnt]) {\n                        eventSubscriptions[evnt].unsubscribe();\n                    }\n                }\n            }\n        };\n        // Check if visible\n        let placeholder = document.getElementById(\"interactions\")\n        if ( placeholder.style.display === \"none\") {\n            placeholder.style.display = \"block\"\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}