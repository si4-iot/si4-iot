{"ast":null,"code":"var _jsxFileName = \"/home/nat/Documentos/IC-TCC/Projeto/catalogo-app/src/components/read.component.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Wot from '@node-wot/core';\n\nconst Description = props => React.createElement(\"tr\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 6\n  },\n  __self: this\n}, React.createElement(\"td\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 7\n  },\n  __self: this\n}, props.description.id), React.createElement(\"td\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 8\n  },\n  __self: this\n}, props.description.title));\n\nfunction get_td(addr) {\n  servient.start().then(thingFactory => {\n    thingFactory.fetch(addr).then(td => {\n      var thing = thingFactory.consume(td);\n      showInteractions(thing);\n    }).catch(error => {\n      window.alert(\"Could not fetch TD.\\n\" + error);\n    });\n  });\n}\n\nfunction showInteractions(thing) {\n  counterProperties = [];\n\n  for (let property in thing.properties) {\n    if (thing.properties.hasOwnProperty(property)) {\n      let dtItem = document.createElement(\"dt\");\n      counterProperties.push(dtItem);\n      let ddItem = document.createElement(\"dd\");\n      ddItem.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n      ddItem.appendChild(document.createTextNode(\"???\"));\n      let link = document.createElement(\"a\");\n      link.appendChild(document.createTextNode(property));\n      dtItem.appendChild(link);\n      document.getElementById(\"properties\").appendChild(dtItem);\n      document.getElementById(\"properties\").appendChild(ddItem);\n\n      dtItem.onclick = click => {\n        thing.properties[property].read().then(res => {\n          ddItem.textContent = res;\n        } // res => window.alert(property + \": \" + res)\n        ).catch(err => window.alert(\"error: \" + err));\n      }; // update value right-away\n\n\n      dtItem.click();\n    }\n  }\n\n  ;\n\n  for (let action in thing.actions) {\n    if (thing.actions.hasOwnProperty(action)) {\n      let item = document.createElement(\"li\");\n      item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n      let button = document.createElement(\"button\");\n      button.appendChild(document.createTextNode(action));\n      button.className = \"button tiny secondary\";\n      item.appendChild(button);\n      document.getElementById(\"actions\").appendChild(item);\n\n      item.onclick = click => {\n        thing.actions[action].invoke().then(res => {\n          button.style.background = 'rgb(0,255,0,0.2)';\n          setTimeout(function () {\n            button.style.background = null;\n          }, 500);\n          updateProperties();\n        }).catch(err => {\n          button.style.background = 'rgb(255,0,0,0.2)';\n          setTimeout(function () {\n            button.style.background = null;\n          }, 500);\n        });\n      };\n    }\n  }\n\n  ;\n  let eventSubscriptions = {};\n\n  for (let evnt in thing.events) {\n    if (thing.events.hasOwnProperty(evnt)) {\n      let item = document.createElement(\"li\");\n      item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n      let link = document.createElement(\"a\");\n      link.appendChild(document.createTextNode(evnt));\n      let checkbox = document.createElement(\"div\");\n      checkbox.className = \"switch small\";\n      checkbox.innerHTML = '<input id=\"' + evnt + '\" type=\"checkbox\">\\n<label for=\"' + evnt + '\"></label>';\n      item.appendChild(link);\n      item.appendChild(checkbox);\n      document.getElementById(\"events\").appendChild(item);\n\n      checkbox.onclick = click => {\n        if (document.getElementById(evnt).checked && !eventSubscriptions[evnt]) {\n          eventSubscriptions[evnt] = thing.events[evnt].subscribe(response => {\n            // window.alert(\"Event \" + evnt + \" detected\\nMessage: \" + response);\n            updateProperties();\n          }, error => {\n            window.alert(\"Event \" + evnt + \" error\\nMessage: \" + error);\n          });\n        } else if (!document.getElementById(evnt).checked && eventSubscriptions[evnt]) {\n          eventSubscriptions[evnt].unsubscribe();\n        }\n      };\n    }\n  }\n\n  ; // Check if visible\n\n  let placeholder = document.getElementById(\"interactions\");\n\n  if (placeholder.style.display === \"none\") {\n    placeholder.style.display = \"block\";\n  }\n}\n\nexport default class ReadDesc extends Component {\n  constructor(props) {\n    let counterProperties = [];\n    var servient;\n    super(props);\n    this.state = {\n      description: []\n    };\n    this._isMounted = false;\n  }\n\n  updateProperties() {\n    counterProperties.forEach(function (prop) {\n      prop.click();\n    });\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    servient = new Wot.Core.Servient();\n    servient.addClientFactory(new Wot.Http.HttpClientFactory());\n\n    window.onload = () => {\n      get_td(document.getElementById(\"td_addr\").value);\n    };\n\n    axios.get('http://localhost:4000/td/' + this.props.match.params.id).then(response => {\n      this.setState({\n        description: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentDidUpdate() {\n    axios.get('http://localhost:4000/td/').then(response => {\n      this.setState({\n        description: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  descriptionList() {\n    axios.get('http://localhost:4000/td/' + this.props.match.params.id).then(response => {\n      this.state.description.push({\n        id: response.data.id,\n        title: response.data.title\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    return React.createElement(Description, {\n      description: this.state.description,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        marginTop: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, \"Cat\\xE1logo\"), React.createElement(\"table\", {\n      className: \"table table-striped\",\n      style: {\n        marginTop: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"ID\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"Title\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, this.descriptionList())), React.createElement(\"div\", {\n      id: \"topbar\",\n      class: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"medium-12 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Counter Client Example in the Browser\"), React.createElement(\"input\", {\n      type: \"hidden\",\n      id: \"td_addr\",\n      type: \"url\",\n      value: \"http://plugfest.thingweb.io:8083/counter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      id: \"interactions\",\n      class: \"row\",\n      style: \"display: none;\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, \"Properties\")), React.createElement(\"dl\", {\n      id: \"properties\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \"Actions\")), React.createElement(\"ul\", {\n      id: \"actions\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, \"Events\")), React.createElement(\"ul\", {\n      id: \"events\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    })))));\n  }\n\n}","map":{"version":3,"sources":["/home/nat/Documentos/IC-TCC/Projeto/catalogo-app/src/components/read.component.js"],"names":["React","Component","axios","Wot","Description","props","description","id","title","get_td","addr","servient","start","then","thingFactory","fetch","td","thing","consume","showInteractions","catch","error","window","alert","counterProperties","property","properties","hasOwnProperty","dtItem","document","createElement","push","ddItem","setAttribute","appendChild","createTextNode","link","getElementById","onclick","click","read","res","textContent","err","action","actions","item","button","className","invoke","style","background","setTimeout","updateProperties","eventSubscriptions","evnt","events","checkbox","innerHTML","checked","subscribe","response","unsubscribe","placeholder","display","ReadDesc","constructor","state","_isMounted","forEach","prop","componentWillUnmount","componentDidMount","Core","Servient","addClientFactory","Http","HttpClientFactory","onload","value","get","match","params","setState","data","console","log","componentDidUpdate","descriptionList","render","marginTop"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axios from 'axios';\nimport Wot from '@node-wot/core';\n\nconst Description = props => (\n    <tr>\n        <td>{props.description.id}</td>\n        <td>{props.description.title}</td>\n    </tr>\n)\n\nfunction get_td(addr) {\n    servient.start().then((thingFactory) => {\n        thingFactory.fetch(addr).then((td) => {\n            var thing = thingFactory.consume(td);\n            showInteractions(thing);\n        }).catch((error) => {\n            window.alert(\"Could not fetch TD.\\n\" + error)\n        })\n    })\n}\n\nfunction showInteractions(thing) {\n    counterProperties = [];\n    for ( let property in thing.properties ) {\n        if (thing.properties.hasOwnProperty(property)) {\n            let dtItem = document.createElement(\"dt\");\n            counterProperties.push(dtItem);\n            let ddItem = document.createElement(\"dd\");\n            ddItem.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n            ddItem.appendChild(document.createTextNode(\"???\"));\n            let link = document.createElement(\"a\");\n            link.appendChild(document.createTextNode(property));\n            dtItem.appendChild(link);\n            document.getElementById(\"properties\").appendChild(dtItem);\n            document.getElementById(\"properties\").appendChild(ddItem);\n\n            dtItem.onclick = (click) => {\n                thing.properties[property].read()\n                .then(\n                    res => { ddItem.textContent = res; }\n                    // res => window.alert(property + \": \" + res)\n                )\n                .catch(err => window.alert(\"error: \" + err))\n            }\n            \n            // update value right-away\n            dtItem.click();\n        }\n    };\n    for ( let action in thing.actions ) {\n        if (thing.actions.hasOwnProperty(action)) {\n            let item = document.createElement(\"li\");\n            item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n            let button = document.createElement(\"button\");\n            button.appendChild(document.createTextNode(action));\n            button.className = \"button tiny secondary\"\n            item.appendChild(button)\n            document.getElementById(\"actions\").appendChild(item);\n\n            item.onclick = (click) => { \n                thing.actions[action].invoke()\n                    .then((res) => { \n                        button.style.background = 'rgb(0,255,0,0.2)';\n                        setTimeout(function () {\n                          button.style.background = null;\n                        }, 500);\n                        updateProperties();\n                    })\n                    .catch((err) => {\n                        button.style.background = 'rgb(255,0,0,0.2)';\n                        setTimeout(function () {\n                          button.style.background = null;\n                        }, 500);\n                    })\n            }\n        }\n    };\n    let eventSubscriptions = {}\n    for ( let evnt in thing.events ) {\n        if (thing.events.hasOwnProperty(evnt)) {\n            let item = document.createElement(\"li\");\n            item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n            let link = document.createElement(\"a\");\n            link.appendChild(document.createTextNode(evnt));\n\n            let checkbox = document.createElement(\"div\");\n            checkbox.className = \"switch small\"\n            checkbox.innerHTML = '<input id=\"' + evnt + '\" type=\"checkbox\">\\n<label for=\"' + evnt + '\"></label>'\n            item.appendChild(link);\n            item.appendChild(checkbox)\n            document.getElementById(\"events\").appendChild(item);\n\n            checkbox.onclick = (click) => {\n                if (document.getElementById(evnt).checked && !eventSubscriptions[evnt]) {\n                    eventSubscriptions[evnt] = thing.events[evnt].subscribe(\n                        (response) => {\n                            // window.alert(\"Event \" + evnt + \" detected\\nMessage: \" + response);\n                            updateProperties();\n                        },\n                        (error) => { window.alert(\"Event \" + evnt + \" error\\nMessage: \" + error); }\n                    )\n                } else if (!document.getElementById(evnt).checked && eventSubscriptions[evnt]) {\n                    eventSubscriptions[evnt].unsubscribe();\n                }\n            }\n        }\n    };\n    // Check if visible\n    let placeholder = document.getElementById(\"interactions\")\n    if ( placeholder.style.display === \"none\") {\n        placeholder.style.display = \"block\"\n    }\n}\nexport default class ReadDesc extends Component {\n    \n    constructor(props) {\n        let counterProperties = [];\n        var servient;\n        super(props);\n        this.state = {description: []};\n        this._isMounted = false;\n    }\n    \n    \n     \n    \n    updateProperties() {\n        counterProperties.forEach(function(prop) {\n          prop.click();\n        });\n    }\n    \n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n    \n    componentDidMount() {\n        this._isMounted = true;\n\n        servient = new Wot.Core.Servient();\n        servient.addClientFactory(new Wot.Http.HttpClientFactory());\n        window.onload = () => {\n            get_td(document.getElementById(\"td_addr\").value);\n        }\n\n        axios.get('http://localhost:4000/td/'+this.props.match.params.id)\n            .then(response => {\n                this.setState({\n                    description: response.data\n                })\n            })\n            .catch(function(error) {\n                console.log(error)\n            })\n    }\n\n    componentDidUpdate() {\n        axios.get('http://localhost:4000/td/')\n        .then(response => {\n            this.setState({description: response.data});\n        })\n        .catch(function (error) {\n            console.log(error);\n        })   \n    }\n\n    descriptionList() {\n        axios.get('http://localhost:4000/td/'+this.props.match.params.id)\n        .then(response => {\n            this.state.description.push({\n                    id:response.data.id,\n                    title: response.data.title\n                });\n            })\n        .catch(function(error) {\n            console.log(error)\n        })\n        return <Description description={this.state.description} />;\n    }\n\n    render() {\n        return (\n            <div style={{ marginTop: 20 }}>\n                <h3>Catálogo</h3>\n                <table className=\"table table-striped\" style={{ marginTop: 20 }}>\n                    <thead>\n                        <tr>\n                            <th>ID</th>\n                            <th>Title</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        { this.descriptionList() }    \n                    </tbody>\n                </table>\n        <div id=\"topbar\" class=\"row\">\n            <div class=\"medium-12 columns\">\n              <h1>Counter Client Example in the Browser</h1>\n              <input type=\"hidden\" id=\"td_addr\" type=\"url\" value=\"http://plugfest.thingweb.io:8083/counter\"/>\n            </div>\n        </div>\n          <div id=\"interactions\" class=\"row\" style=\"display: none;\">\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Properties</h4></figcaption>\n                <dl id=\"properties\" class=\"side-nav\"></dl>\n              </figure>\n            </div>\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Actions</h4></figcaption>\n                <ul id=\"actions\" class=\"side-nav\"></ul>\n              </figure>\n            </div>\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Events</h4></figcaption>\n                <ul id=\"events\" class=\"side-nav\"></ul>\n              </figure>\n            </div>\n          </div>\n          </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}