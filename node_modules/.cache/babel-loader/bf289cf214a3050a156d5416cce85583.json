{"ast":null,"code":"var _jsxFileName = \"/home/nat/Documentos/IC-TCC/Projeto/catalogo-app/src/components/read.component.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios'; // WoT imports, needed for several components\n\nimport * as Core from '@node-wot/core';\nimport * as Http from '@node-wot/binding-http';\nexport const WoT = {\n  Core,\n  Http,\n  WebSocket\n};\n\nconst Description = props => React.createElement(\"tr\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 15\n  },\n  __self: this\n}, React.createElement(\"td\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 16\n  },\n  __self: this\n}, props.description.id), React.createElement(\"td\", {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 17\n  },\n  __self: this\n}, props.description.title));\n\nexport default class ReadDesc extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      description: [],\n      counterProperties: []\n    };\n    this._isMounted = false;\n  }\n\n  get_td(addr) {\n    this.servient.start().then(thingFactory => {\n      thingFactory.fetch(addr).then(td => {\n        var thing = thingFactory.consume(td);\n        this.showInteractions(thing);\n      }).catch(error => {\n        window.alert(\"Could not fetch TD.\\n\" + error);\n      });\n    });\n  }\n\n  showInteractions(thing) {\n    this.counterProperties = [];\n\n    for (let property in thing.properties) {\n      if (thing.properties.hasOwnProperty(property)) {\n        let dtItem = document.createElement(\"dt\");\n        this.counterProperties.push(dtItem);\n        let ddItem = document.createElement(\"dd\");\n        ddItem.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n        ddItem.appendChild(document.createTextNode(\"???\"));\n        let link = document.createElement(\"a\");\n        link.appendChild(document.createTextNode(property));\n        dtItem.appendChild(link);\n        document.getElementById(\"properties\").appendChild(dtItem);\n        document.getElementById(\"properties\").appendChild(ddItem);\n\n        dtItem.onclick = click => {\n          thing.properties[property].read().then(res => {\n            ddItem.textContent = res;\n          } // res => window.alert(property + \": \" + res)\n          ).catch(err => window.alert(\"error: \" + err));\n        }; // update value right-away\n\n\n        dtItem.click();\n      }\n    }\n\n    ;\n\n    for (let action in thing.actions) {\n      if (thing.actions.hasOwnProperty(action)) {\n        let item = document.createElement(\"li\");\n        item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n        let button = document.createElement(\"button\");\n        button.appendChild(document.createTextNode(action));\n        button.className = \"button tiny secondary\";\n        item.appendChild(button);\n        document.getElementById(\"actions\").appendChild(item);\n\n        item.onclick = click => {\n          thing.actions[action].invoke().then(res => {\n            button.style.background = 'rgb(0,255,0,0.2)';\n            setTimeout(function () {\n              button.style.background = null;\n            }, 500);\n            this.updateProperties();\n          }).catch(err => {\n            button.style.background = 'rgb(255,0,0,0.2)';\n            setTimeout(function () {\n              button.style.background = null;\n            }, 500);\n          });\n        };\n      }\n    }\n\n    ;\n    let eventSubscriptions = {};\n\n    for (let evnt in thing.events) {\n      if (thing.events.hasOwnProperty(evnt)) {\n        let item = document.createElement(\"li\");\n        item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n\n        let link = document.createElement(\"a\");\n        link.appendChild(document.createTextNode(evnt));\n        let checkbox = document.createElement(\"div\");\n        checkbox.className = \"switch small\";\n        checkbox.innerHTML = '<input id=\"' + evnt + '\" type=\"checkbox\">\\n<label for=\"' + evnt + '\"></label>';\n        item.appendChild(link);\n        item.appendChild(checkbox);\n        document.getElementById(\"events\").appendChild(item);\n\n        checkbox.onclick = click => {\n          if (document.getElementById(evnt).checked && !eventSubscriptions[evnt]) {\n            eventSubscriptions[evnt] = thing.events[evnt].subscribe(response => {\n              // window.alert(\"Event \" + evnt + \" detected\\nMessage: \" + response);\n              this.updateProperties();\n            }, error => {\n              window.alert(\"Event \" + evnt + \" error\\nMessage: \" + error);\n            });\n          } else if (!document.getElementById(evnt).checked && eventSubscriptions[evnt]) {\n            eventSubscriptions[evnt].unsubscribe();\n          }\n        };\n      }\n    }\n\n    ; // Check if visible\n\n    let placeholder = document.getElementById(\"interactions\");\n\n    if (placeholder.style.display === \"none\") {\n      placeholder.style.display = \"block\";\n    }\n  }\n\n  updateProperties() {\n    this.counterProperties.forEach(function (prop) {\n      prop.click();\n    });\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    const servient = new WoT.Core.Servient();\n    servient.addClientFactory(new WoT.Http.HttpClientFactory());\n    servient.addClientFactory(new WoT.WebSocket.WebSocketClientFactory());\n    servient.addClientFactory(new WoT.WebSocket.WebSocketSecureClientFactory());\n    servient.start().then(wot => {\n      this.setState({\n        wot\n      });\n    });\n    axios.get('http://localhost:4000/td/' + this.props.match.params.id).then(response => {\n      this.setState({\n        description: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  componentDidUpdate() {\n    axios.get('http://localhost:4000/td/').then(response => {\n      this.setState({\n        description: response.data\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  descriptionList() {\n    axios.get('http://localhost:4000/td/' + this.props.match.params.id).then(response => {\n      this.state.description.push({\n        id: response.data.id,\n        title: response.data.title\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    return React.createElement(Description, {\n      description: this.state.description,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      style: {\n        marginTop: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, \"Cat\\xE1logo\"), React.createElement(\"table\", {\n      className: \"table table-striped\",\n      style: {\n        marginTop: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, \"ID\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Title\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, this.descriptionList())), React.createElement(\"div\", {\n      id: \"topbar\",\n      class: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"medium-12 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, \"Counter Client Example in the Browser\"), React.createElement(\"input\", {\n      type: \"hidden\",\n      id: \"td_addr\",\n      type: \"url\",\n      value: \"http://plugfest.thingweb.io:8083/counter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      id: \"interactions\",\n      class: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, \"Properties\")), React.createElement(\"dl\", {\n      id: \"properties\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, \"Actions\")), React.createElement(\"ul\", {\n      id: \"actions\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      class: \"medium-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, React.createElement(\"figure\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, React.createElement(\"figcaption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, \"Events\")), React.createElement(\"ul\", {\n      id: \"events\",\n      class: \"side-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    })))));\n  }\n\n}","map":{"version":3,"sources":["/home/nat/Documentos/IC-TCC/Projeto/catalogo-app/src/components/read.component.js"],"names":["React","Component","axios","Core","Http","WoT","WebSocket","Description","props","description","id","title","ReadDesc","constructor","state","counterProperties","_isMounted","get_td","addr","servient","start","then","thingFactory","fetch","td","thing","consume","showInteractions","catch","error","window","alert","property","properties","hasOwnProperty","dtItem","document","createElement","push","ddItem","setAttribute","appendChild","createTextNode","link","getElementById","onclick","click","read","res","textContent","err","action","actions","item","button","className","invoke","style","background","setTimeout","updateProperties","eventSubscriptions","evnt","events","checkbox","innerHTML","checked","subscribe","response","unsubscribe","placeholder","display","forEach","prop","componentWillUnmount","componentDidMount","Servient","addClientFactory","HttpClientFactory","WebSocketClientFactory","WebSocketSecureClientFactory","wot","setState","get","match","params","data","console","log","componentDidUpdate","descriptionList","render","marginTop"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axios from 'axios';\n\n// WoT imports, needed for several components\nimport * as Core from '@node-wot/core';\nimport * as Http from '@node-wot/binding-http';\n\nexport const WoT = {\n    Core,\n    Http,\n    WebSocket\n};\n  \nconst Description = props => (\n    <tr>\n        <td>{props.description.id}</td>\n        <td>{props.description.title}</td>\n    </tr>\n)\n\n\nexport default class ReadDesc extends Component {\n    \n    constructor(props) {\n        super(props);\n        this.state = {\n            description: [], \n            counterProperties: []};\n        this._isMounted = false;\n        \n    }\n    \n    \n    get_td(addr) {\n        this.servient.start().then((thingFactory) => {\n            thingFactory.fetch(addr).then((td) => {\n                var thing = thingFactory.consume(td);\n                this.showInteractions(thing);\n            }).catch((error) => {\n                window.alert(\"Could not fetch TD.\\n\" + error)\n            })\n        })\n    }\n    \n    showInteractions(thing) {\n        this.counterProperties = [];\n        for ( let property in thing.properties ) {\n            if (thing.properties.hasOwnProperty(property)) {\n                let dtItem = document.createElement(\"dt\");\n                this.counterProperties.push(dtItem);\n                let ddItem = document.createElement(\"dd\");\n                ddItem.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n                ddItem.appendChild(document.createTextNode(\"???\"));\n                let link = document.createElement(\"a\");\n                link.appendChild(document.createTextNode(property));\n                dtItem.appendChild(link);\n                document.getElementById(\"properties\").appendChild(dtItem);\n                document.getElementById(\"properties\").appendChild(ddItem);\n    \n                dtItem.onclick = (click) => {\n                    thing.properties[property].read()\n                    .then(\n                        res => { ddItem.textContent = res; }\n                        // res => window.alert(property + \": \" + res)\n                    )\n                    .catch(err => window.alert(\"error: \" + err))\n                }\n                \n                // update value right-away\n                dtItem.click();\n            }\n        };\n        for ( let action in thing.actions ) {\n            if (thing.actions.hasOwnProperty(action)) {\n                let item = document.createElement(\"li\");\n                item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n                let button = document.createElement(\"button\");\n                button.appendChild(document.createTextNode(action));\n                button.className = \"button tiny secondary\"\n                item.appendChild(button)\n                document.getElementById(\"actions\").appendChild(item);\n    \n                item.onclick = (click) => { \n                    thing.actions[action].invoke()\n                        .then((res) => { \n                            button.style.background = 'rgb(0,255,0,0.2)';\n                            setTimeout(function () {\n                              button.style.background = null;\n                            }, 500);\n                            this.updateProperties();\n                        })\n                        .catch((err) => {\n                            button.style.background = 'rgb(255,0,0,0.2)';\n                            setTimeout(function () {\n                              button.style.background = null;\n                            }, 500);\n                        })\n                }\n            }\n        };\n        let eventSubscriptions = {}\n        for ( let evnt in thing.events ) {\n            if (thing.events.hasOwnProperty(evnt)) {\n                let item = document.createElement(\"li\");\n                item.setAttribute('dir', 'auto'); // direction-independence, direction-heuristic\n                let link = document.createElement(\"a\");\n                link.appendChild(document.createTextNode(evnt));\n    \n                let checkbox = document.createElement(\"div\");\n                checkbox.className = \"switch small\"\n                checkbox.innerHTML = '<input id=\"' + evnt + '\" type=\"checkbox\">\\n<label for=\"' + evnt + '\"></label>'\n                item.appendChild(link);\n                item.appendChild(checkbox)\n                document.getElementById(\"events\").appendChild(item);\n    \n                checkbox.onclick = (click) => {\n                    if (document.getElementById(evnt).checked && !eventSubscriptions[evnt]) {\n                        eventSubscriptions[evnt] = thing.events[evnt].subscribe(\n                            (response) => {\n                                // window.alert(\"Event \" + evnt + \" detected\\nMessage: \" + response);\n                                this.updateProperties();\n                            },\n                            (error) => { window.alert(\"Event \" + evnt + \" error\\nMessage: \" + error); }\n                        )\n                    } else if (!document.getElementById(evnt).checked && eventSubscriptions[evnt]) {\n                        eventSubscriptions[evnt].unsubscribe();\n                    }\n                }\n            }\n        };\n        // Check if visible\n        let placeholder = document.getElementById(\"interactions\")\n        if ( placeholder.style.display === \"none\") {\n            placeholder.style.display = \"block\"\n        }\n    }\n    \n    updateProperties() {\n        this.counterProperties.forEach(function(prop) {\n          prop.click();\n        });\n    }\n    \n    componentWillUnmount() {\n        this._isMounted = false;\n        \n    }\n    \n    componentDidMount() {\n        this._isMounted = true;\n\n        const servient = new WoT.Core.Servient();\n        servient.addClientFactory(new WoT.Http.HttpClientFactory());\n        servient.addClientFactory(new WoT.WebSocket.WebSocketClientFactory());\n        servient.addClientFactory(new WoT.WebSocket.WebSocketSecureClientFactory());\n        servient.start().then(wot => {\n        this.setState({ wot });\n        });\n\n        axios.get('http://localhost:4000/td/'+this.props.match.params.id)\n            .then(response => {\n                this.setState({\n                    description: response.data\n                })\n            })\n            .catch(function(error) {\n                console.log(error)\n            })\n    }\n\n    componentDidUpdate() {\n        axios.get('http://localhost:4000/td/')\n        .then(response => {\n            this.setState({description: response.data});\n        })\n        .catch(function (error) {\n            console.log(error);\n        })   \n    }\n\n    descriptionList() {\n        axios.get('http://localhost:4000/td/'+this.props.match.params.id)\n        .then(response => {\n            this.state.description.push({\n                    id:response.data.id,\n                    title: response.data.title\n                });\n            })\n        .catch(function(error) {\n            console.log(error)\n        })\n        return <Description description={this.state.description} />;\n    }\n\n    render() {\n        return (\n            <div style={{ marginTop: 20 }}>\n                <h3>Catálogo</h3>\n                <table className=\"table table-striped\" style={{ marginTop: 20 }}>\n                    <thead>\n                        <tr>\n                            <th>ID</th>\n                            <th>Title</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        { this.descriptionList() }    \n                    </tbody>\n                </table>\n        <div id=\"topbar\" class=\"row\">\n            <div class=\"medium-12 columns\">\n              <h1>Counter Client Example in the Browser</h1>\n              <input type=\"hidden\" id=\"td_addr\" type=\"url\" value=\"http://plugfest.thingweb.io:8083/counter\"/>\n            </div>\n        </div>\n          <div id=\"interactions\" class=\"row\" >\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Properties</h4></figcaption>\n                <dl id=\"properties\" class=\"side-nav\"></dl>\n              </figure>\n            </div>\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Actions</h4></figcaption>\n                <ul id=\"actions\" class=\"side-nav\"></ul>\n              </figure>\n            </div>\n            <div class=\"medium-4 columns\">\n              <figure>\n                <figcaption><h4>Events</h4></figcaption>\n                <ul id=\"events\" class=\"side-nav\"></ul>\n              </figure>\n            </div>\n          </div>\n          </div>\n        )\n    }\n\n   \n}"]},"metadata":{},"sourceType":"module"}